<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Attachment Helper</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <link rel="stylesheet" href="taskpane.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ“ Email Helper</h1>
      <p class="subtitle">Upload file lÃªn OneDrive</p>
    </header>

    <!-- Step 1: Chá»n file -->
    <section id="step-upload" class="step-section">
      <button id="btn-pick-file" class="btn-primary">
        ğŸ“‚ Chá»n file Ä‘á»ƒ upload
      </button>
      <input type="file" id="file-input" style="display: none;">
      <div id="file-info" class="file-info" style="display: none;">
        <span id="file-name"></span>
        <span id="file-size" class="file-size"></span>
      </div>
    </section>

    <!-- Step 2: Progress -->
    <section id="step-progress" class="step-section" style="display: none;">
      <p class="progress-label">â³ Äang táº£i lÃªn...</p>
      <div class="progress-bar-container">
        <div id="progress-bar" class="progress-bar" style="width: 0%;"></div>
      </div>
      <p id="progress-text" class="progress-text">0%</p>
    </section>

    <!-- Step 3: Chá»n quyá»n -->
    <section id="step-permission" class="step-section" style="display: none;">
      <p class="permission-label">Chá»n quyá»n cho ngÆ°á»i nháº­n:</p>
      <button id="btn-view" class="btn-permission btn-view">
        ğŸ‘ Chá»‰ xem
      </button>
      <button id="btn-edit" class="btn-permission btn-edit">
        âœï¸ Xem vÃ  sá»­a
      </button>
    </section>

    <!-- Step 4: ThÃ nh cÃ´ng -->
    <section id="step-done" class="step-section" style="display: none;">
      <div class="done-card">
        <p class="done-icon">âœ…</p>
        <p class="done-text">Xong! Link Ä‘Ã£ chÃ¨n vÃ o email.</p>
      </div>
      <button id="btn-upload-more" class="btn-secondary">
        ğŸ“‚ Upload thÃªm file
      </button>
    </section>

    <!-- Step Error -->
    <section id="step-error" class="step-section" style="display: none;">
      <div class="error-card">
        <p class="error-icon">âŒ</p>
        <p id="error-text" class="error-text"></p>
      </div>
      <button id="btn-retry" class="btn-secondary">
        ğŸ”„ Thá»­ láº¡i
      </button>
    </section>

    <!-- File Manager -->
    <section id="file-manager" class="file-manager-section">
      <h3>ğŸ“‹ File Ä‘Ã£ upload</h3>
      <ul id="file-list" class="file-list">
        <li class="file-list-empty">ChÆ°a cÃ³ file nÃ o</li>
      </ul>
    </section>

    <footer>
      <p>Email Attachment Helper v0.2.0</p>
    </footer>
  </div>

  <script type="module" src="taskpane.ts"></script>
</body>
</html>
